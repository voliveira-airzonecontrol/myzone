schema: '2.0'
stages:
  fetch_data:
    cmd: python -m src.data_injection.fetch_data --env prod
    deps:
    - path: src/data_injection/fetch_data.py
      hash: md5
      md5: 3a77c73df82e99c69c97d4047db96fde
      size: 2791
    outs:
    - path: raw_data/prod/articulos.csv
      hash: md5
      md5: 08ce4d3eefebadcb42e9c45c00cd8ece
      size: 8671729
    - path: raw_data/prod/estados.csv
      hash: md5
      md5: 2ff4c4cc55108bf413f8037ebcd63024
      size: 635
    - path: raw_data/prod/incidencias.csv
      hash: md5
      md5: 631cf5ece12d219e539dbf91cae8e779
      size: 9842404
    - path: raw_data/prod/incidencias_tipo.csv
      hash: md5
      md5: b026a6c3874000996c2fab945740cf03
      size: 177
    - path: raw_data/prod/piezas.csv
      hash: md5
      md5: 80f20a0b2cde00fa6fc7a9ed700e9c06
      size: 10847074
  translate_data:
    cmd: python -m src.preprocessing.translation --env prod --input-incidencias raw_data/prod/incidencias.csv
      --input-piezas raw_data/prod/piezas.csv --input-estados raw_data/prod/estados.csv
      --input-incidencias-tipo raw_data/prod/incidencias_tipo.csv --output-path output_data/prod
    deps:
    - path: raw_data/prod/estados.csv
      hash: md5
      md5: 2ff4c4cc55108bf413f8037ebcd63024
      size: 635
    - path: raw_data/prod/incidencias.csv
      hash: md5
      md5: 631cf5ece12d219e539dbf91cae8e779
      size: 9842404
    - path: raw_data/prod/incidencias_tipo.csv
      hash: md5
      md5: b026a6c3874000996c2fab945740cf03
      size: 177
    - path: raw_data/prod/piezas.csv
      hash: md5
      md5: 80f20a0b2cde00fa6fc7a9ed700e9c06
      size: 10847074
    - path: src/preprocessing/translation.py
      hash: md5
      md5: 91fef21391f2e44e84c17368af0961ae
      size: 7493
    outs:
    - path: output_data/prod/desc_problema_translated.csv
      hash: md5
      md5: aad85c78210027e8b598ed74907c47e9
      size: 2700584
    - path: output_data/prod/descripcion_translated.csv
      hash: md5
      md5: 74df7f95474cc7e1eed8ad2bff3caf06
      size: 670371
    - path: output_data/prod/problema_translated.csv
      hash: md5
      md5: dd00b03c2ee1bb3296fae0a558e58f7c
      size: 2083721
  find_best_matches:
    cmd: python -m src.preprocessing.find_best_matches --env prod --input-piezas raw_data/prod/piezas.csv
      --input-articulos raw_data/prod/articulos.csv --output-best-matches output_data/prod/fuzzy_matches_w_scores.csv
    deps:
    - path: raw_data/prod/articulos.csv
      hash: md5
      md5: 08ce4d3eefebadcb42e9c45c00cd8ece
      size: 8671729
    - path: raw_data/prod/piezas.csv
      hash: md5
      md5: 80f20a0b2cde00fa6fc7a9ed700e9c06
      size: 10847074
    outs:
    - path: output_data/prod/fuzzy_matches_w_scores.csv
      hash: md5
      md5: e6160a0c3920a96fd821e6acc9e557fb
      size: 2365187
  preprocessing:
    cmd: python -m src.preprocessing.preprocessing --env prod --translation-data-folder
      output_data/prod --raw-data-folder raw_data/prod --input-best-matches output_data/prod/fuzzy_matches_w_scores.csv
      --input-articulos raw_data/prod/articulos.csv --output-path output_data/prod/preprocessed_data.csv
    deps:
    - path: output_data/prod/desc_problema_translated.csv
      hash: md5
      md5: aad85c78210027e8b598ed74907c47e9
      size: 2700584
    - path: output_data/prod/descripcion_translated.csv
      hash: md5
      md5: 74df7f95474cc7e1eed8ad2bff3caf06
      size: 670371
    - path: output_data/prod/fuzzy_matches_w_scores.csv
      hash: md5
      md5: e6160a0c3920a96fd821e6acc9e557fb
      size: 2365187
    - path: output_data/prod/problema_translated.csv
      hash: md5
      md5: dd00b03c2ee1bb3296fae0a558e58f7c
      size: 2083721
    - path: raw_data/prod/articulos.csv
      hash: md5
      md5: 08ce4d3eefebadcb42e9c45c00cd8ece
      size: 8671729
    - path: raw_data/prod/estados.csv
      hash: md5
      md5: 2ff4c4cc55108bf413f8037ebcd63024
      size: 635
    - path: raw_data/prod/incidencias.csv
      hash: md5
      md5: 631cf5ece12d219e539dbf91cae8e779
      size: 9842404
    - path: raw_data/prod/incidencias_tipo.csv
      hash: md5
      md5: b026a6c3874000996c2fab945740cf03
      size: 177
    - path: raw_data/prod/piezas.csv
      hash: md5
      md5: 80f20a0b2cde00fa6fc7a9ed700e9c06
      size: 10847074
    - path: src/preprocessing/preprocessing.py
      hash: md5
      md5: da7380610822ceffdd2d814e468398a9
      size: 4035
    outs:
    - path: output_data/prod/preprocessed_data.csv
      hash: md5
      md5: fe9bc6ab505164064602ffe1a9f80853
      size: 10908505
  generate_corpus:
    cmd: python -m src.preprocessing.generate_corpus --env prod --input-preprocessed-data
      output_data/prod/preprocessed_data.csv --input-documentation-path 
      \\central4\Publica\Product_technical_documentation-Documentación_técnica_producto
      --input-training-data-path "C:/Users/voliveira/OneDrive - Corporacion Empresarial
      Altra SL/00-Proyectos/Datos - Myzone/TrainningData" --output-corpus output_data/prod/corpus.csv
    deps:
    - path: output_data/prod/preprocessed_data.csv
      hash: md5
      md5: fe9bc6ab505164064602ffe1a9f80853
      size: 10908505
    - path: src/preprocessing/generate_corpus.py
      hash: md5
      md5: 1daf1d56a6179f5943e4c3056a4a69d4
      size: 4922
    outs:
    - path: output_data/prod/corpus.csv
      hash: md5
      md5: d312a39c2ea823c1531e7d2a21eb176a
      size: 26559624
  tfidf_encoding:
    cmd: python -m src.encoding.tfidf_encoding --env prod --input-data output_data/prod/preprocessed_data.csv
      --output-tfidf-encoded-data output_data/prod/tfidf_encoded_data.csv --output-tfidf-model
      encode_models/prod/tfidf_model.joblib
    deps:
    - path: output_data/prod/preprocessed_data.csv
      hash: md5
      md5: fe9bc6ab505164064602ffe1a9f80853
      size: 10908505
    - path: src/encoding/tfidf_encoding.py
      hash: md5
      md5: c44953ea76a7c5db2255b731c80f8989
      size: 5225
    outs:
    - path: output_data/prod/tfidf_encoded_data.csv
      hash: md5
      md5: bb9a59243677689e58d1a4efb29e84d9
      size: 3386039
  doc2vec_encoding:
    cmd: python -m src.encoding.doc2vec_encoding --env prod --input-data output_data/prod/preprocessed_data.csv
      --input-corpus output_data/prod/corpus.csv --output-doc2vec-encoded-data output_data/prod/doc2vec_encoded_data.csv
      --output-doc2vec-model encode_models/prod/doc2vec_model.joblib
    deps:
    - path: output_data/prod/corpus.csv
      hash: md5
      md5: d312a39c2ea823c1531e7d2a21eb176a
      size: 26559624
    - path: src/encoding/doc2vec_encoding.py
      hash: md5
      md5: 03928210ec96aa2d0462be93e4c0bd5c
      size: 6527
    outs:
    - path: output_data/prod/doc2vec_encoded_data.csv
      hash: md5
      md5: 1b9e5a1a74a0df2b8d93913906a52916
      size: 729544783
  sentence_transformer_encoding:
    cmd: python -m src.encoding.sentence_transformer_encoding --env prod --input-data
      output_data/prod/preprocessed_data.csv --output-sentence-transformer-encoded-data
      output_data/prod/sentence_transformer_encoded_data.csv
    deps:
    - path: output_data/prod/preprocessed_data.csv
      hash: md5
      md5: fe9bc6ab505164064602ffe1a9f80853
      size: 10908505
    - path: src/encoding/sentence_transformer_encoding.py
      hash: md5
      md5: 50e5887470936e698075675d6f29bbaa
      size: 4440
    outs:
    - path: output_data/prod/sentence_transformer_encoded_data.csv
      hash: md5
      md5: cfd2e3f6203980cd42d556576d3fd05b
      size: 315977587
